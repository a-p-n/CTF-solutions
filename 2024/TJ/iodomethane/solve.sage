enc = [8103443654527565038, 9131436358818679900, 4957881569325453096, 10608823513649500284, 6675039786579943629, 6611905972844131155, 1244757961681113340, 7547487070745190563, 1913848887301325654, 9737862765813246630, 2820240734893834667, 4787888165190302097, 11681061051439179359, 11976272630379115896, 2884226871403054033, 13149362434991348085, 2676520484503789480, 6933002550284269375, 6634913706901406922, 3790038065981008837, 7593117393518680210, 1266282031812681717, 14297832010203960867, 6803759075981258244, 2235840587449302546, 9573113061825958419, 7208484535445728720, 3230648965441849617, 14844603229849620928, 2548590493342454145, 12648684202717570605, 8664656898390315577, 13502288186462622020, 8391628990279857365, 5501744205282111713, 5327399420219427046, 904912426181632886, 4805354280735678357, 12915117098149429818, 12340346813869037506, 9907136040657333887, 12822605127735793613]
alphabet = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0192834756{}_!@#$%^&*()"

limit = len(alphabet)
modulus = 15106021798142166691


def dot(a,b):
    return sum([a[i] * b[i] for i in range(len(a))]) % modulus

def mult(key, row):
    return [dot(key[i], row) for i in range(len(key))]

cipher_mat = matrix(GF(modulus),[[8103443654527565038, 9131436358818679900, 4957881569325453096],[ 10608823513649500284, 6675039786579943629, 6611905972844131155], [1244757961681113340, 7547487070745190563, 1913848887301325654]]).T
check_mat = matrix(GF(modulus),[[8391628990279857365, 5501744205282111713, 5327399420219427046],[ 904912426181632886, 4805354280735678357, 12915117098149429818], [12340346813869037506, 9907136040657333887, 12822605127735793613]]).T

possible_keys = []
for x in range(limit):
    for y in range(limit):
        for z in range(limit):
            known = matrix(GF(modulus),[[19,19,x],[9,5,y],[2,62,z]])
            if det(known) != 0:
                key = cipher_mat*known.inverse()
                possible_keys.append(key)
                if det(key) != 0:
                    pt = key.inverse()*check_mat
                    for i in pt.list():
                        if i < limit:
                            if alphabet[i] == '}':
                                print(pt.list())
                                print(key)
                                print("-"*69)

# key
# [12934538888778852970 14106184789125022533  6521043309579161543]
# [  371172527159073119 14625922759749025408  3200024844167281093]
# [  220038281078136945 12924684968718363851  2651581947756455005]