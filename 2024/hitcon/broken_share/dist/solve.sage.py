

# This file was *autogenerated* from the file /home/apn/Documents/bi0s/my_git/CTF-solutions/2024/hitcon/broken_share/dist/solve.sage
from sage.all_cmdline import *   # import sage library

_sage_const_65537 = Integer(65537); _sage_const_18565 = Integer(18565); _sage_const_15475 = Integer(15475); _sage_const_4050 = Integer(4050); _sage_const_20443 = Integer(20443); _sage_const_7053 = Integer(7053); _sage_const_28908 = Integer(28908); _sage_const_46320 = Integer(46320); _sage_const_10236 = Integer(10236); _sage_const_12604 = Integer(12604); _sage_const_25691 = Integer(25691); _sage_const_34890 = Integer(34890); _sage_const_55908 = Integer(55908); _sage_const_20396 = Integer(20396); _sage_const_47463 = Integer(47463); _sage_const_16840 = Integer(16840); _sage_const_10456 = Integer(10456); _sage_const_29951 = Integer(29951); _sage_const_4074 = Integer(4074); _sage_const_43326 = Integer(43326); _sage_const_55872 = Integer(55872); _sage_const_15136 = Integer(15136); _sage_const_21784 = Integer(21784); _sage_const_42111 = Integer(42111); _sage_const_55432 = Integer(55432); _sage_const_32311 = Integer(32311); _sage_const_30534 = Integer(30534); _sage_const_28577 = Integer(28577); _sage_const_18600 = Integer(18600); _sage_const_35425 = Integer(35425); _sage_const_34192 = Integer(34192); _sage_const_38838 = Integer(38838); _sage_const_6433 = Integer(6433); _sage_const_40776 = Integer(40776); _sage_const_31807 = Integer(31807); _sage_const_29826 = Integer(29826); _sage_const_36077 = Integer(36077); _sage_const_39458 = Integer(39458); _sage_const_24811 = Integer(24811); _sage_const_32328 = Integer(32328); _sage_const_28111 = Integer(28111); _sage_const_38079 = Integer(38079); _sage_const_11245 = Integer(11245); _sage_const_36995 = Integer(36995); _sage_const_27991 = Integer(27991); _sage_const_26261 = Integer(26261); _sage_const_59236 = Integer(59236); _sage_const_42176 = Integer(42176); _sage_const_20756 = Integer(20756); _sage_const_11071 = Integer(11071); _sage_const_50313 = Integer(50313); _sage_const_31327 = Integer(31327); _sage_const_7724 = Integer(7724); _sage_const_14212 = Integer(14212); _sage_const_45911 = Integer(45911); _sage_const_22884 = Integer(22884); _sage_const_22299 = Integer(22299); _sage_const_18878 = Integer(18878); _sage_const_50951 = Integer(50951); _sage_const_23510 = Integer(23510); _sage_const_24001 = Integer(24001); _sage_const_61462 = Integer(61462); _sage_const_57669 = Integer(57669); _sage_const_46222 = Integer(46222); _sage_const_34450 = Integer(34450); _sage_const_29 = Integer(29); _sage_const_5836 = Integer(5836); _sage_const_50316 = Integer(50316); _sage_const_15548 = Integer(15548); _sage_const_24558 = Integer(24558); _sage_const_15321 = Integer(15321); _sage_const_9571 = Integer(9571); _sage_const_19074 = Integer(19074); _sage_const_11188 = Integer(11188); _sage_const_44856 = Integer(44856); _sage_const_36698 = Integer(36698); _sage_const_40296 = Integer(40296); _sage_const_6125 = Integer(6125); _sage_const_33078 = Integer(33078); _sage_const_42862 = Integer(42862); _sage_const_49258 = Integer(49258); _sage_const_22439 = Integer(22439); _sage_const_56745 = Integer(56745); _sage_const_37914 = Integer(37914); _sage_const_56174 = Integer(56174); _sage_const_53950 = Integer(53950); _sage_const_16717 = Integer(16717); _sage_const_17342 = Integer(17342); _sage_const_59992 = Integer(59992); _sage_const_48528 = Integer(48528); _sage_const_39826 = Integer(39826); _sage_const_59647 = Integer(59647); _sage_const_57687 = Integer(57687); _sage_const_30823 = Integer(30823); _sage_const_36629 = Integer(36629); _sage_const_65052 = Integer(65052); _sage_const_7106 = Integer(7106); _sage_const_24 = Integer(24); _sage_const_8 = Integer(8)
import itertools
from hashlib import sha256
from Crypto.Cipher import AES
from sage.all import *

p = _sage_const_65537 
F = GF(p)
PR = PolynomialRing(F, names=('x',)); (x,) = PR._first_ngens(1)

def find_polynomial(shares, t):
    for coeffs in itertools.product(range(p), repeat=t):
        poly = PR(list(coeffs))
        if all(poly(x) == y for x, y in shares):
            return poly
    return None

shares = [(_sage_const_18565 , _sage_const_15475 ), (_sage_const_4050 , _sage_const_20443 ), (_sage_const_7053 , _sage_const_28908 ), (_sage_const_46320 , _sage_const_10236 ), (_sage_const_12604 , _sage_const_25691 ), (_sage_const_34890 , _sage_const_55908 ), (_sage_const_20396 , _sage_const_47463 ), (_sage_const_16840 , _sage_const_10456 ), (_sage_const_29951 , _sage_const_4074 ), (_sage_const_43326 , _sage_const_55872 ), (_sage_const_15136 , _sage_const_21784 ), (_sage_const_42111 , _sage_const_55432 ), (_sage_const_32311 , _sage_const_30534 ), (_sage_const_28577 , _sage_const_18600 ), (_sage_const_35425 , _sage_const_34192 ), (_sage_const_38838 , _sage_const_6433 ), (_sage_const_40776 , _sage_const_31807 ), (_sage_const_29826 , _sage_const_36077 ), (_sage_const_39458 , _sage_const_24811 ), (_sage_const_32328 , _sage_const_28111 ), (_sage_const_38079 , _sage_const_11245 ), (_sage_const_36995 , _sage_const_27991 ), (_sage_const_26261 , _sage_const_59236 ), (_sage_const_42176 , _sage_const_20756 ), (_sage_const_11071 , _sage_const_50313 ), (_sage_const_31327 , _sage_const_7724 ), (_sage_const_14212 , _sage_const_45911 ), (_sage_const_22884 , _sage_const_22299 ), (_sage_const_18878 , _sage_const_50951 ), (_sage_const_23510 , _sage_const_24001 ), (_sage_const_61462 , _sage_const_57669 ), (_sage_const_46222 , _sage_const_34450 ), (_sage_const_29 , _sage_const_5836 ), (_sage_const_50316 , _sage_const_15548 ), (_sage_const_24558 , _sage_const_15321 ), (_sage_const_9571 , _sage_const_19074 ), (_sage_const_11188 , _sage_const_44856 ), (_sage_const_36698 , _sage_const_40296 ), (_sage_const_6125 , _sage_const_33078 ), (_sage_const_42862 , _sage_const_49258 ), (_sage_const_22439 , _sage_const_56745 ), (_sage_const_37914 , _sage_const_56174 ), (_sage_const_53950 , _sage_const_16717 ), (_sage_const_17342 , _sage_const_59992 ), (_sage_const_48528 , _sage_const_39826 ), (_sage_const_59647 , _sage_const_57687 ), (_sage_const_30823 , _sage_const_36629 ), (_sage_const_65052 , _sage_const_7106 )]
ct = b'\xa4\x17#U\x9d[2Sg\xb9\x99B\xe8p\x8b\x0b\x14\xf0\x04\xde\x88\xb9\xf6\xceM/\xea\xbf\x15\x99\xd7\xaf\x8c\xa1t\xa4%~c%\xd2\x1dNl\xbaF\x92\xae(\xca\xf8$+\xebd;^\xb8\xb3`\xf0\xed\x8a\x9do'

poly = find_polynomial(shares, _sage_const_24 )
if poly:
    ks = [poly(i) for i in range(_sage_const_24 )]
    key = sha256(repr(ks).encode()).digest()
    cipher = AES.new(key, AES.MODE_CTR, nonce=ct[:_sage_const_8 ])
    print(cipher.decrypt(ct[_sage_const_8 :]))
else:
    print("Polynomial not found")

